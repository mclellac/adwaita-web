{% extends "base.html" %}

{% block title %}Settings - {{ super() }}{% endblock %}

{% block content %}
  <adw-preferences-view style="max-width: 700px; margin: var(--spacing-xl) auto;">
    <adw-preferences-page title="Settings">
      <adw-preferences-group title="Appearance">
        <adw-list-box>
          <adw-switch-row title="Enable Dark Mode"
                          subtitle="Toggle between light (off) and dark (on) themes"
                          id="theme-switch"
                          data-current-theme="{{ current_user.theme or 'system' }}">
          </adw-switch-row>
          <adw-combo-row title="Accent Color"
                         subtitle="Choose a site-wide accent color"
                         id="accent-color-combo"
                         data-current-accent="{{ current_user.accent_color or 'default' }}">
            <!-- Options will be populated by JavaScript.
                 Example:
                 <option value="default" selected>Default (Blue)</option>
                 <option value="green">Green</option>
                 <option value="orange">Orange</option>
                 <option value="purple">Purple</option>
                 <option value="red">Red</option>
                 <option value="yellow">Yellow</option>
            -->
          </adw-combo-row>
        </adw-list-box>
      </adw-preferences-group>

      <adw-preferences-group title="Account">
        <adw-list-box>
          <adw-action-row title="Change Password" subtitle="Update your account password" clickable href="{{ url_for('change_password_page') }}"></adw-action-row>
          <adw-action-row title="Logout" subtitle="Sign out of your account" clickable href="{{ url_for('logout') }}" class="destructive-action"></adw-action-row>
        </adw-list-box>
      </adw-preferences-group>

    </adw-preferences-page>
  </adw-preferences-view>
{% endblock %}

{% block scripts %}
{{ super() }}
<script>
  // Provide URLs for settings.js
  window.settingsUrls = {
    saveThemeUrl: "{{ url_for('save_theme_preference') }}",
    saveAccentUrl: "{{ url_for('save_accent_color_preference') }}",
    csrfToken: "{{ csrf_token() }}" // Also pass CSRF token here for cleaner JS
  };
</script>
<script src="{{ url_for('static', filename='js/settings.js') }}"></script>
{% endblock %}
