{% extends "base.html" %}

{% block title %}Create New Post{% endblock %}

{% block content %}
<div class="main-content-clamped">
    <h1 style="margin-bottom: var(--spacing-l);">Create New Post</h1> {# Using h1 for page title #}
    <form method="POST" action="{{ url_for('create_post') }}" novalidate>
        {{ form.hidden_tag() }} {# CSRF token #}
        <adw-list-box style="margin-bottom: var(--spacing-l);">
            {# Replace adw-entry-row with direct form field rendering for title #}
            <div class="adw-preferences-row" style="padding: var(--spacing-s) var(--spacing-m);">
                <div class="adw-preferences-row__title-area">
                    {{ form.title.label(class_="adw-label") }}
                </div>
                <div class="adw-preferences-row__control-area" style="flex-grow: 1;">
                    {{ form.title(class_="adw-entry", style="width: 100%;", placeholder="Enter post title", required=form.title.flags.required) }}
                </div>
                {% if form.title.errors %}
                <div class="adw-preferences-row__title-area"></div> {# Spacer for alignment #}
                <div class="adw-preferences-row__control-area errors" style="color: var(--error-color); font-size: var(--font-size-small); margin-top: var(--spacing-xxs);">
                    {% for error in form.title.errors %}{{ error }}<br>{% endfor %}
                </div>
                {% endif %}
            </div>

            {# Content Field - using a generic row structure inside list-box #}
            <div class="adw-row" style="padding: var(--spacing-s) var(--spacing-m); display: flex; flex-direction: column;">
                {{ form.content.label(class_='adw-label', style='margin-bottom: var(--spacing-xs);') }}
                {{ form.content(class_='adw-entry', rows='10', id=form.content.id or 'content_field', placeholder='Write your blog post here...', style='width: 100%; min-height: 150px;') }}
                {% if form.content.errors %}
                    <div class="errors" style="color: var(--error-color); font-size: var(--font-size-small); margin-top: var(--spacing-xs);">
                        {% for error in form.content.errors %}{{ error }}<br>{% endfor %}
                    </div>
                {% endif %}
            </div>

            {# Categories Field #}
            <div class="adw-row" style="padding: var(--spacing-s) var(--spacing-m); display: flex; flex-direction: column;">
                {{ form.categories.label(class_='adw-label', style='margin-bottom: var(--spacing-s); font-weight: bold;') }}
                <div class="adw-checkbox-group" style="display: flex; flex-direction: column; gap: var(--spacing-xs);">
                    {{ form.categories() }} {# Renders as a list of checkboxes #}
                </div>
                {% if form.categories.errors %}
                    <div class="errors" style="color: var(--error-color); font-size: var(--font-size-small); margin-top: var(--spacing-xs);">
                        {% for error in form.categories.errors %}{{ error }}<br>{% endfor %}
                    </div>
                {% endif %}
            </div>

            <adw-entry-row
                title="{{ form.tags_string.label.text }}"
                name="{{ form.tags_string.name }}"
                id="{{ form.tags_string.id or 'tags_string_field' }}"
                placeholder="e.g., tech, travel, food"
                value="{{ form.tags_string.data or '' }}"
                subtitle="{{ form.tags_string.errors[0] if form.tags_string.errors else 'Comma-separated values.' }}">
            </adw-entry-row>
        </adw-list-box>

        <div style="display: flex; justify-content: flex-end; gap: var(--spacing-s);">
            {{ form.submit(class_='adw-button suggested-action') }}
        </div>
    </form>
</div>
{% endblock %}
