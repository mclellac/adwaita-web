{% extends "base.html" %}

{% block title %}Create New Post{% endblock %}

{% block styles %}
{{ super() }}
<style>
  .tiptap-toolbar {
    display: flex;
    gap: var(--spacing-xs);
    margin-bottom: var(--spacing-s);
    flex-wrap: wrap;
  }
  .tiptap-toolbar button {
    background-color: var(--button-secondary-background-color);
    color: var(--button-secondary-text-color);
    border: 1px solid var(--button-secondary-border-color);
    border-radius: var(--radius-s);
    padding: var(--spacing-xxs) var(--spacing-xs);
    cursor: pointer;
    font-weight: bold;
  }
  .tiptap-toolbar button.is-active {
    background-color: var(--accent-color);
    color: var(--accent-text-color);
    border-color: var(--accent-color);
  }
  /* Ensure labels for checkboxes are clickable and aligned */
  .adw-checkbox-row label {
    vertical-align: middle;
    margin-left: var(--spacing-s); /* Spacing between checkbox and label text */
  }
  .adw-checkbox-row .adw-action-row__title { /* If using title slot for label */
    margin-left: var(--spacing-s);
  }
  .adw-checkbox-row {
    /* If you want the whole row to be clickable to toggle the checkbox: */
    /* cursor: pointer; */
  }
  .adw-preferences-group .errors { /* Common error styling */
    color: var(--error-color);
    font-size: var(--font-size-small);
    margin-top: var(--spacing-xxs);
    padding-left: var(--spacing-m); /* Align with content if inside a listbox/row structure */
  }
  .adw-list-box.has-error {
      /* Maybe a border or background to indicate error in the group */
  }
  .adw-entry-row.has-error, .adw-action-row.has-error {
      /* Standard error indication for rows already applies via subtitle or Adwaita's own styling */
  }
</style>
{% endblock %}

{% block content %}
<div class="main-content-clamped" style="padding: 20px;"> {# Basic clamp replacement #}
  <h2>Create New Post (Diagnostic View)</h2>
  <form method="POST" action="{{ url_for('create_post') }}" novalidate>
      {{ form.hidden_tag() }} {# CSRF token #}

      <p>
          {{ form.title.label }}<br>
          {{ form.title(size=30, class='adw-entry') }}<br>
          {% if form.title.errors %}
              {% for error in form.title.errors %}<span style="color:red;">[{{ error }}]</span><br>{% endfor %}
          {% endif %}
      </p>

      <p>
          {{ form.content.label }}<br>
          {{ form.content(rows=10, cols=70, class='adw-entry', style='resize:vertical;') }}<br>
          {% if form.content.errors %}
              {% for error in form.content.errors %}<span style="color:red;">[{{ error }}]</span><br>{% endfor %}
          {% endif %}
      </p>

      <p>
          {{ form.categories.label }}<br>
          {# Basic rendering for categories checkbox #}
          {% for subfield in form.categories %}
              {{ subfield }} {{ subfield.label }}<br>
          {% endfor %}
          {% if form.categories.errors %}
              {% for error in form.categories.errors %}<span style="color:red;">[{{ error }}]</span><br>{% endfor %}
          {% endif %}
      </p>

      <p>
          {{ form.tags_string.label }}<br>
          {{ form.tags_string(size=50, class='adw-entry') }}<br>
          {% if form.tags_string.errors %}
              {% for error in form.tags_string.errors %}<span style="color:red;">[{{ error }}]</span><br>{% endfor %}
          {% endif %}
      </p>

      <p>
          {# Rendering submit as a standard button for diagnostics #}
          <input type="submit" value="{{ form.submit.label.text if form.submit.label else 'Submit Post' }}">
      </p>
  </form>
</div>
{% endblock %}

{% block scripts %}
{{ super() }}
{# No Tiptap-specific scripts needed anymore #}
{% endblock %}
