{% extends "base.html" %}

{% block title %}Profile: {{ user_profile.username }} - My Libadwaita Blog{% endblock %}

{% block content %}
<div class="adw-box adw-box-vertical align-center content-clamp" style="max-width: 600px; gap: var(--spacing-m); margin-left: auto; margin-right: auto;"> {# Added auto margins for clamping #}

        {# Avatar Display - Copied from previous version, centering via inline style is fine here #}
        {% if user_profile.profile_photo_url %}
            <span class="adw-avatar size-large" style="margin-bottom: var(--spacing-m); display: block; margin-left: auto; margin-right: auto;">
                <img src="{{ url_for('static', filename=user_profile.profile_photo_url) }}" alt="{{ user_profile.username }}'s avatar" class="avatar-image">
            </span>
        {% else %}
            <span class="adw-avatar size-large" style="margin-bottom: var(--spacing-m); display: block; margin-left: auto; margin-right: auto;">
                <span class="adw-avatar-text" style="font-size: 24px; line-height: 72px;">
                    {% set name_parts = user_profile.username.split() %}
                    {% if name_parts|length >= 2 %}
                        {{ name_parts[0][0]|upper }}{{ name_parts[1][0]|upper }}
                    {% elif user_profile.username %}
                        {{ user_profile.username[0:2]|upper }}
                    {% else %}
                        ??
                    {% endif %}
                </span>
            </span>
        {% endif %}

        <div class="adw-row" style="width: 100%;">
            <strong class="adw-label" style="margin-right: var(--spacing-s);">Username:</strong> <span class="adw-label">{{ user_profile.username }}</span>
        </div>
        {# Using adw-expander-row for potentially long profile information #}
        <adw-expander-row title="Profile Information" subtitle="View user's bio" style="width: 100%;">
            <p style="padding-top: var(--spacing-s);">{{ user_profile.profile_info if user_profile.profile_info else 'No profile information provided.' }}</p>
        </adw-expander-row>

        {% if current_user and current_user.username == user_profile.username %}
        <div style="margin-top: var(--spacing-m);"> {# Added a div for spacing for the button #}
            <adw-button appearance="suggested" href="{{ url_for('edit_profile') }}">Edit Profile</adw-button>
        </div>
        {% endif %}

        <h2 style="margin-top: var(--spacing-l); width: 100%; text-align: center;">Posts by {{ user_profile.username }}</h2>
            {% if user_profile.posts and user_profile.posts|length > 0 %}
                <adw-list-box style="width: 100%;">
                    {% for post in user_profile.posts %}
                        <adw-action-row
                            title="{{ post.title }}"
                            subtitle="Posted on: {{ post.created_at.strftime('%Y-%m-%d %H:%M') if post.created_at else 'N/A' }} UTC"
                            href="{{ url_for('view_post', post_id=post.id) }}">
                        </adw-action-row>
                    {% endfor %}
                </adw-list-box>
            {% else %}
                <adw-status-page title="No Posts Yet" description="{{ user_profile.username }} has not made any posts.">
                    <div slot="icon" style="font-size: 4.5rem; margin-bottom: var(--spacing-l); opacity: 0.7;">üìù</div> {# Using a different emoji placeholder #}
                </adw-status-page>
            {% endif %}

    </div>
{% endblock %}
