<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Adwaita Web - Declarative Demo</title>
    <link rel="stylesheet" href="app-demo/static/css/adwaita-web.css">
    <!-- components.js must be loaded as a module because it uses ES6 import/export -->
    <script type="module" src="app-demo/static/js/components.js" defer></script>
    <!-- adw-initializer.js depends on Adw global from components.js, defer ensures it runs after HTML parsing -->
    <script src="app-demo/static/js/adw-initializer.js" defer></script>
    <style>
        body { margin: 0; display: flex; flex-direction: column; min-height: 100vh; }
        adw-application-window { flex-grow: 1; display: flex; flex-direction: column; }
        .main-content-area { padding: var(--spacing-l); overflow-y: auto; flex-grow: 1; }
        .widget-showcase { margin-bottom: var(--spacing-l); }
        .widget-showcase > adw-label[title-level="1"] { margin-bottom: var(--spacing-m); }
        .button-group adw-button { margin-right: var(--spacing-s); margin-bottom: var(--spacing-s); }
    </style>
</head>
<body>
    <adw-application-window id="main-window">
        <adw-header-bar slot="header" id="main-header-bar">
            <adw-button slot="start" icon="<svg width='16' height='16'><path d='M2 8l6-6v4h6v4H8v4z'/></svg>" id="header-back-button" aria-label="Back"></adw-button>
            <adw-window-title slot="title" title="Adwaita Widgets" subtitle="Declarative Demo"></adw-window-title>
            <adw-button slot="end" id="theme-toggle-button">Toggle Theme</adw-button>
            <adw-button slot="end" icon="<svg width='16' height='16'><path d='M2 3h12v2H2zm0 4h12v2H2zm0 4h12v2H2z'/></svg>" id="header-menu-button" aria-label="Menu"></adw-button>
        </adw-header-bar>

        <div class="main-content-area">
            <adw-label title-level="1">Adwaita Web Component Showcase</adw-label>
            <adw-label is-body style="margin-bottom: var(--spacing-l);">
                This page demonstrates various Adwaita-Web components.
                Use the "Toggle Theme" button in the header to switch between light and dark modes.
                Use the accent color picker below to change the accent color.
            </adw-label>

            <!-- Accent Color Picker -->
            <section class="widget-showcase">
                <adw-label title-level="2">Theme Controls</adw-label>
                <adw-box orientation="horizontal" spacing="s" id="accent-color-picker-container" style="align-items: center; margin-bottom: var(--spacing-m);">
                    <adw-label>Accent Color:</adw-label>
                    {/* Buttons will be added here by JS */}
                </adw-box>
                 <details>
                    <summary>Show Accent Picker Code (JS)</summary>
                    <pre><code>
// In main script:
const accentPickerContainer = document.getElementById('accent-color-picker-container');
const accentColors = Adw.getAccentColors(); // Returns [{id: 'blue', name: 'Blue'}, ...]
accentColors.forEach(color => {
    const button = Adw.createButton(color.name, {
        onClick: () => Adw.setAccentColor(color.id)
    });
    // Basic preview (relies on CSS variables being available)
    button.style.setProperty('--button-bg-color', \`var(--accent-\${color.id}-light-bg)\`);
    button.style.setProperty('--button-fg-color', \`var(--accent-\${color.id}-light-fg)\`);
    accentPickerContainer.appendChild(button);
});
                    </code></pre>
                </details>
            </section>

            <!-- Buttons Section -->
            <section class="widget-showcase">
                <adw-label title-level="2">Buttons</adw-label>
                <div class="button-group">
                    <adw-button id="btn-click-me">Click Me!</adw-button>
                    <adw-button id="btn-suggested" suggested>Suggested</adw-button>
                    <adw-button id="btn-destructive" destructive>Destructive</adw-button>
                    <adw-button id="btn-flat" flat>Flat</adw-button>
                    <adw-button id="btn-disabled" disabled>Disabled</adw-button>
                </div>
                <div class="button-group" style="margin-top: var(--spacing-s);">
                    <adw-button icon-name="actions/document-save-symbolic" id="btn-icon-text">Save</adw-button>
                    <adw-button icon-name="actions/document-open-symbolic" suggested id="btn-icon-text-suggested">Open</adw-button>
                    <adw-button icon-name="actions/edit-delete-symbolic" destructive id="btn-icon-text-destructive">Delete</adw-button>
                    <adw-button icon-name="actions/document-new-symbolic" flat id="btn-icon-text-flat">New</adw-button>
                    <adw-button icon-name="actions/document-print-symbolic" disabled id="btn-icon-text-disabled">Print (Disabled)</adw-button>
                </div>
                <div class="button-group" style="margin-top: var(--spacing-s);">
                    <adw-button circular icon-name="actions/camera-photo-symbolic" aria-label="Take Photo" id="btn-circular"></adw-button>
                    <adw-button circular icon-name="actions/call-start-symbolic" suggested aria-label="Start Call" id="btn-circular-suggested"></adw-button>
                    <adw-button circular icon-name="actions/call-stop-symbolic" destructive aria-label="End Call" id="btn-circular-destructive"></adw-button>
                    <adw-button circular icon-name="ui/pan-down-symbolic" flat aria-label="More Info" id="btn-circular-flat"></adw-button>
                    <adw-button circular icon-name="actions/application-exit-symbolic" disabled aria-label="Exit (Disabled)" id="btn-circular-disabled"></adw-button>
                </div>
                 <details>
                    <summary>Show Button Examples</summary>
                    <pre><code>&lt;adw-button&gt;Click Me!&lt;/adw-button&gt;
&lt;adw-button suggested&gt;Suggested&lt;/adw-button&gt;
&lt;adw-button icon-name="actions/document-save-symbolic"&gt;Save&lt;/adw-button&gt;
&lt;adw-button circular icon-name="actions/camera-photo-symbolic" aria-label="Take Photo"&gt;&lt;/adw-button&gt;</code></pre>
                </details>
            </section>

            <!-- Icons Section -->
            <section class="widget-showcase">
                <adw-label title-level="2">Icons (&lt;adw-icon&gt;)</adw-label>
                <adw-box orientation="horizontal" spacing="m" style="align-items: center; font-size: 24px;">
                    <adw-icon icon-name="actions/document-new-symbolic" aria-label="New Document"></adw-icon>
                    <adw-icon icon-name="actions/document-save-symbolic" style="color: var(--accent-color);"></adw-icon>
                    <adw-icon icon-name="status/dialog-error-symbolic" style="color: var(--error-color); font-size: 32px;"></adw-icon>
                    <adw-icon icon-name="ui/pan-up-symbolic"></adw-icon>
                    <adw-icon icon-name="devices/camera-photo-symbolic"></adw-icon>
                    <adw-icon icon-name="a-missing-icon-name"></adw-icon> {/* Error case */}
                </adw-box>
                 <details>
                    <summary>Show Icon Examples</summary>
                    <pre><code>&lt;adw-icon icon-name="actions/document-new-symbolic"&gt;&lt;/adw-icon&gt;
&lt;adw-icon icon-name="status/dialog-error-symbolic" style="color: var(--error-color);"&gt;&lt;/adw-icon&gt;</code></pre>
                </details>
            </section>

            <!-- Controls Section (Checkbox, Radio, Switch, SpinButton, SplitButton, ToggleButton, ToggleGroup) -->
            <section class="widget-showcase">
                <adw-label title-level="2">Controls</adw-label>
                <adw-box orientation="vertical" spacing="m">
                    <adw-row>
                        <adw-checkbox label="Enable Feature" id="chk-1" checked></adw-checkbox>
                        <adw-checkbox label="Disabled Checkbox" disabled></adw-checkbox>
                        <adw-switch id="switch-1"></adw-switch>
                        <adw-switch checked disabled id="switch-2"></adw-switch>
                    </adw-row>
                    <adw-row>
                        <adw-label>Radio Group:</adw-label>
                        <adw-radio-button label="Alpha" name="my-radio-group" value="alpha" checked></adw-radio-button>
                        <adw-radio-button label="Beta" name="my-radio-group" value="beta"></adw-radio-button>
                        <adw-radio-button label="Gamma" name="my-radio-group" value="gamma" disabled></adw-radio-button>
                    </adw-row>
                    <adw-row style="align-items: center;">
                        <adw-label>Spin Button:</adw-label>
                        <adw-spin-button id="spin-btn-1" value="5" min="0" max="10" step="1"></adw-spin-button>
                        <adw-label>Disabled Spin:</adw-label>
                        <adw-spin-button value="3" disabled></adw-spin-button>
                    </adw-row>
                    <adw-row style="align-items: center;">
                        <adw-label>Split Button:</adw-label>
                        <adw-split-button action-text="Main Action" id="split-btn-1">
                            {/* Menu would be populated by JS for now, or a dedicated adw-menu component */}
                        </adw-split-button>
                        <adw-split-button action-text="Save" action-icon-name="actions/document-save-symbolic" suggested id="split-btn-2"></adw-split-button>
                        <adw-split-button action-text="Disabled" disabled></adw-split-button>
                    </adw-row>
                     <adw-row style="align-items: center;">
                        <adw-label>Toggle Buttons:</adw-label>
                        <adw-toggle-button label="Toggle Me" id="toggle-btn-1"></adw-toggle-button>
                        <adw-toggle-button icon-name="actions/media-playback-start-symbolic" aria-label="Play" active id="toggle-btn-2"></adw-toggle-button>
                        <adw-toggle-button label="Disabled" disabled></adw-toggle-button>
                    </adw-row>
                    <adw-row>
                        <adw-label>Toggle Group (Linked):</adw-label>
                        <adw-toggle-group linked id="toggle-group-1" active-value="opt2">
                            <adw-toggle-button label="Option 1" value="opt1"></adw-toggle-button>
                            <adw-toggle-button label="Option 2" value="opt2"></adw-toggle-button>
                            <adw-toggle-button label="Option 3" value="opt3"></adw-toggle-button>
                        </adw-toggle-group>
                    </adw-row>
                </adw-box>
                 <details>
                    <summary>Show Controls Examples</summary>
                    <pre><code>&lt;adw-checkbox label="Enable" checked&gt;&lt;/adw-checkbox&gt;
&lt;adw-switch&gt;&lt;/adw-switch&gt;
&lt;adw-spin-button value="5" min="0" max="10"&gt;&lt;/adw-spin-button&gt;
&lt;adw-split-button action-text="Action"&gt;&lt;/adw-split-button&gt;
&lt;adw-toggle-button label="Toggle"&gt;&lt;/adw-toggle-button&gt;
&lt;adw-toggle-group linked active-value="b"&gt;
  &lt;adw-toggle-button label="A" value="a"&gt;&lt;/adw-toggle-button&gt;
  &lt;adw-toggle-button label="B" value="b"&gt;&lt;/adw-toggle-button&gt;
&lt;/adw-toggle-group&gt;</code></pre>
                </details>
            </section>

            <!-- Rows Section (ActionRow, EntryRow, PasswordEntryRow, ExpanderRow, ComboRow, SpinRow, ButtonRow) -->
            <section class="widget-showcase">
                <adw-label title-level="2">Rows</adw-label>
                <adw-list-box>
                    <adw-action-row title="Simple Action Row" subtitle="With a subtitle" activatable id="simple-action-row"></adw-action-row>
                    <adw-action-row title="Action Row with Icon" subtitle="And chevron" icon-name="apps/help-contents-symbolic" show-chevron activatable></adw-action-row>
                    <adw-entry-row title="Username" placeholder="Enter your username"></adw-entry-row>
                    <adw-password-entry-row title="Password" placeholder="Enter password"></adw-password-entry-row>
                    <adw-expander-row title="Expandable Section" subtitle="Click to see more" id="expander-row-1">
                        <adw-label is-body style="padding: var(--spacing-m);">Content for the first expander.</adw-label>
                        <adw-action-row title="Nested Item"></adw-action-row>
                    </adw-expander-row>
                    <adw-expander-row title="Initially Expanded" subtitle="Some details" expanded>
                        <adw-label is-body style="padding: var(--spacing-m);">This section is open by default.</adw-label>
                    </adw-expander-row>
                    <adw-combo-row title="Select Option" id="combo-row-1">
                        <option value="1">Option One</option>
                        <option value="2" selected>Option Two</option>
                        <option value="3">Option Three</option>
                    </adw-combo-row>
                    <adw-spin-row title="Adjust Value" min="0" max="20" value="10" step="2"></adw-spin-row>
                    <adw-button-row centered>
                        <adw-button>Cancel</adw-button>
                        <adw-button suggested>Apply</adw-button>
                    </adw-button-row>
                </adw-list-box>
                <adw-label title-level="3" style="margin-top:var(--spacing-m);">Flat ListBox</adw-label>
                <adw-list-box flat>
                     <adw-action-row title="Flat Action Row"></adw-action-row>
                     <adw-entry-row title="Flat Entry Row"></adw-entry-row>
                </adw-list-box>
                 <details>
                    <summary>Show Row Examples</summary>
                    <pre><code>&lt;adw-list-box&gt;
  &lt;adw-action-row title="Title" subtitle="Subtitle" icon-name="actions/document-properties-symbolic" show-chevron activatable&gt;&lt;/adw-action-row&gt;
  &lt;adw-entry-row title="Name" placeholder="Enter name"&gt;&lt;/adw-entry-row&gt;
  &lt;adw-expander-row title="Details"&gt;...content...&lt;/adw-expander-row&gt;
  &lt;adw-combo-row title="Choose"&gt;&lt;option value="a"&gt;A&lt;/option&gt;&lt;/adw-combo-row&gt;
&lt;/adw-list-box&gt;</code></pre>
                </details>
            </section>

            <!-- Dialogs Section -->
            <section class="widget-showcase">
                <adw-label title-level="2">Dialogs</adw-label>
                <adw-box orientation="horizontal" spacing="s">
                    <adw-button id="trigger-alert-dialog">Show Alert Dialog</adw-button>
                    <adw-button id="trigger-about-dialog">Show About Dialog</adw-button>
                    <adw-button id="trigger-preferences-dialog">Show Preferences Dialog</adw-button>
                </adw-box>

                <adw-alert-dialog id="alert-dialog-example" heading="Confirm Action" body="Are you sure you want to proceed with this action?">
                    <adw-button slot="choice" value="cancel">Cancel</adw-button>
                    <adw-button slot="choice" value="confirm" data-style="destructive">Confirm</adw-button>
                </adw-alert-dialog>

                <adw-about-dialog id="about-dialog-example" app-name="Adwaita Web" version="0.1.0"
                    logo="app-demo/static/img/adwaita-web-logo.svg"
                    developer-name="Jules the AI Agent"
                    copyright="© 2024 The Adwaita Web Authors"
                    comments="A demonstration of Adwaita styling for the web."
                    website="https://example.com"
                    license-type="MIT License">
                    <ul slot="developers"><li>Jules</li></ul>
                </adw-about-dialog>

                <adw-preferences-dialog id="preferences-dialog-example" title="My Application Preferences">
                    <adw-preferences-page name="general" title="General">
                        <adw-preferences-group title="Appearance">
                            <adw-action-row title="Theme" subtitle="System Default"></adw-action-row>
                            <adw-combo-row title="Accent Color">
                                <option value="blue">Blue</option>
                                <option value="green">Green</option>
                            </adw-combo-row>
                        </adw-preferences-group>
                    </adw-preferences-page>
                    <adw-preferences-page name="advanced" title="Advanced">
                        <adw-preferences-group title="Experimental Features">
                            <adw-switch-row title="Enable Beta Features"></adw-switch-row>
                        </adw-preferences-group>
                    </adw-preferences-page>
                </adw-preferences-dialog>
                 <details>
                    <summary>Show Dialog Trigger Examples</summary>
                    <pre><code>&lt;adw-button id="show-alert"&gt;Show Alert&lt;/adw-button&gt;
&lt;adw-alert-dialog id="my-alert" heading="Title" body="Message."&gt;
  &lt;adw-button slot="choice" value="ok"&gt;OK&lt;/adw-button&gt;
&lt;/adw-alert-dialog&gt;
&lt;script&gt;document.getElementById('show-alert').onclick = () => document.getElementById('my-alert').open();&lt;/script&gt;</code></pre>
                </details>
            </section>

            <!-- Other Misc Components -->
            <section class="widget-showcase">
                <adw-label title-level="2">Miscellaneous</adw-label>
                <adw-label title-level="3">Progress Bar</adw-label>
                <adw-progress-bar value="60" style="margin-bottom: var(--spacing-s);"></adw-progress-bar>
                <adw-progress-bar indeterminate></adw-progress-bar>

                <adw-label title-level="3" style="margin-top:var(--spacing-m);">Spinner</adw-label>
                <adw-spinner active></adw-spinner>

                <adw-label title-level="3" style="margin-top:var(--spacing-m);">Avatar</adw-label>
                <adw-avatar text="AW" size="48"></adw-avatar>

                <adw-label title-level="3" style="margin-top:var(--spacing-m);">Status Page</adw-label>
                <adw-status-page title="All Done!" icon-name="status/emblem-ok-symbolic">
                    <adw-label slot="description">You have completed all tasks.</adw-label>
                </adw-status-page>

                <adw-label title-level="3" style="margin-top:var(--spacing-m);">Banner & Toast</adw-label>
                <adw-box orientation="horizontal" spacing="s" id="banner-toast-trigger-container">
                    <adw-button id="trigger-banner">Show Banner</adw-button>
                    <adw-button id="trigger-toast">Show Toast</adw-button>
                </adw-box>
                <div id="banner-container-main" style="margin-top: var(--spacing-s);"></div>
                 <details>
                    <summary>Show Misc Component Examples</summary>
                    <pre><code>&lt;adw-progress-bar value="60"&gt;&lt;/adw-progress-bar&gt;
&lt;adw-spinner active&gt;&lt;/adw-spinner&gt;
&lt;adw-avatar text="AW"&gt;&lt;/adw-avatar&gt;
&lt;adw-status-page title="Done!" icon-name="status/emblem-ok-symbolic"&gt;...&lt;/adw-status-page&gt;</code></pre>
                </details>
            </section>

            <!-- Layout Components -->
            <section class="widget-showcase">
                <adw-label title-level="2">Layouts</adw-label>
                <adw-label title-level="3">Box</adw-label>
                <adw-box orientation="horizontal" spacing="m" style="padding:var(--spacing-s); border:1px dashed var(--border-color);">
                    <adw-button>Box Child 1</adw-button>
                    <adw-label>Box Child 2</adw-label>
                    <adw-entry placeholder="Box Child 3"></adw-entry>
                </adw-box>

                <adw-label title-level="3" style="margin-top:var(--spacing-m);">Clamp</adw-label>
                <adw-clamp maximum-size="40ch" style="padding:var(--spacing-s); border:1px dashed var(--border-color);">
                    <adw-label is-body>This text is clamped to a maximum width of 40 characters. It will not grow wider than that, ensuring readability even if the parent container is very wide.</adw-label>
                </adw-clamp>

                <adw-label title-level="3" style="margin-top:var(--spacing-m);">Flap</adw-label>
                 <adw-button id="toggle-main-flap">Toggle Flap</adw-button>
                <adw-flap id="main-flap-example" style="border: 1px solid var(--border-color); margin-top: var(--spacing-s); min-height: 150px;">
                    <adw-box slot="flap-content" style="padding: var(--spacing-m); background: var(--sidebar-bg-color);" min-width="200px">
                        <adw-label title-level="3">Flap Content</adw-label>
                        <adw-action-row title="Settings"></adw-action-row>
                    </adw-box>
                    <adw-box slot="main-content" style="padding: var(--spacing-m);">
                        <adw-label title-level="3">Main Content (Flap Demo)</adw-label>
                    </adw-box>
                </adw-flap>
                 <details>
                    <summary>Show Layout Examples</summary>
                    <pre><code>&lt;adw-box orientation="horizontal" spacing="m"&gt;...&lt;/adw-box&gt;
&lt;adw-clamp maximum-size="40ch"&gt;...&lt;/adw-clamp&gt;
&lt;adw-flap&gt;
  &lt;div slot="flap-content"&gt;...&lt;/div&gt;
  &lt;div slot="main-content"&gt;...&lt;/div&gt;
&lt;/adw-flap&gt;</code></pre>
                </details>
            </section>

            <!-- View Components -->
            <section class="widget-showcase">
                <adw-label title-level="2">Views</adw-label>
                <adw-label title-level="3">ViewSwitcher &amp; TabView (Conceptual)</adw-label>
                 <adw-tab-view id="main-tab-view" style="border: 1px solid var(--border-color); min-height: 200px;">
                    <adw-tab-page name="tab1" title="First Tab" icon-name="categories/applications-graphics-symbolic">
                        <adw-box style="padding:var(--spacing-l);">Content of Tab 1</adw-box>
                    </adw-tab-page>
                    <adw-tab-page name="tab2" title="Second Tab" icon-name="categories/applications-multimedia-symbolic" active>
                        <adw-box style="padding:var(--spacing-l);">Content of Tab 2. More text to see wrapping.</adw-box>
                    </adw-tab-page>
                    <adw-tab-page name="tab3" title="Third Tab (Closeable)" icon-name="categories/applications-utilities-symbolic" closeable>
                        <adw-box style="padding:var(--spacing-l);">This tab can be closed.</adw-box>
                    </adw-tab-page>
                </adw-tab-view>
                <details>
                    <summary>Show View Examples</summary>
                    <pre><code>&lt;adw-tab-view&gt;
  &lt;adw-tab-page name="t1" title="Tab 1" icon-name="actions/document-new-symbolic"&gt;...&lt;/adw-tab-page&gt;
  &lt;adw-tab-page name="t2" title="Tab 2" active&gt;...&lt;/adw-tab-page&gt;
&lt;/adw-tab-view&gt;</code></pre>
                </details>
            </section>

            <div style="height: 200px;"></div> {/* Extra space at bottom */}
        </div>
    </adw-application-window>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        if (!window.Adw) {
            console.error("Adw object not found. Aborting main script in index.html.");
            return;
        }

        // --- Header Bar ---
        document.getElementById('theme-toggle-button')?.addEventListener('click', Adw.toggleTheme);
        // Add other header bar listeners if needed

        // --- Accent Color Picker ---
        const accentPickerContainer = document.getElementById('accent-color-picker-container');
        if (accentPickerContainer) {
            const accentColors = Adw.getAccentColors(); // Expects [{id: 'blue', name: 'Blue'}, ...]
            accentColors.forEach(color => {
                const button = Adw.createButton(color.name, {
                    onClick: () => {
                        Adw.setAccentColor(color.id);
                        // Optionally, re-style the buttons if needed after global accent change,
                        // but ideally they just use standard button styles that react to the theme.
                    }
                });
                // Style the button to use its specific accent for its border,
                // but let its main background/foreground come from standard button theming.
                // This way, it adapts to light/dark mode better.
                // We need to know if light or dark theme is active to pick the right standalone color.
                const isLightTheme = document.body.classList.contains('light-theme');
                const standaloneColorVar = isLightTheme ? `var(--accent-${color.id}-light-standalone)` : `var(--accent-${color.id}-dark-standalone)`;
                const bgColorVar = isLightTheme ? `var(--accent-${color.id}-light-bg)` : `var(--accent-${color.id}-dark-bg)`;
                const fgColorVar = isLightTheme ? `var(--accent-${color.id}-light-fg)` : `var(--accent-${color.id}-dark-fg)`;

                // For the demo, let's make the buttons themselves use their accent color
                // This will make them visually represent the color they set.
                button.style.setProperty('background-color', bgColorVar);
                button.style.setProperty('color', fgColorVar);
                button.style.setProperty('border-color', standaloneColorVar);
                // To ensure text is readable, especially for yellow, we might need to adjust
                if (color.id === 'yellow') {
                    button.style.setProperty('color', 'rgba(0,0,0,0.8)'); // Force dark text on yellow
                }


                accentPickerContainer.appendChild(button);
            });

            // Re-style accent buttons if theme changes
            new MutationObserver((mutationsList, observer) => {
                for(const mutation of mutationsList) {
                    if (mutation.type === 'attributes' && mutation.attributeName === 'class') {
                        const isLightThemeCurrent = document.body.classList.contains('light-theme');
                        accentPickerContainer.querySelectorAll('adw-button').forEach(btn => {
                            // Find the color.id for this button. This is a bit fragile.
                            // Assumes button text is unique or we store color.id on the button.
                            const colorName = btn.textContent;
                            const accentColorObj = accentColors.find(ac => ac.name === colorName);
                            if (accentColorObj) {
                                const colorId = accentColorObj.id;
                                const newStandaloneColorVar = isLightThemeCurrent ? `var(--accent-${colorId}-light-standalone)` : `var(--accent-${colorId}-dark-standalone)`;
                                const newBgColorVar = isLightThemeCurrent ? `var(--accent-${colorId}-light-bg)` : `var(--accent-${colorId}-dark-bg)`;
                                const newFgColorVar = isLightThemeCurrent ? `var(--accent-${colorId}-light-fg)` : `var(--accent-${colorId}-dark-fg)`;

                                btn.style.setProperty('background-color', newBgColorVar);
                                btn.style.setProperty('color', newFgColorVar);
                                btn.style.setProperty('border-color', newStandaloneColorVar);
                                if (colorId === 'yellow') {
                                    btn.style.setProperty('color', 'rgba(0,0,0,0.8)');
                                }
                            }
                        });
                        break; // Only need to react once per class change
                    }
                }
            }).observe(document.body, { attributes: true });

        } else {
            console.warn("Accent color picker container not found.");
        }

        // --- General Button Toasts (for quick feedback) ---
        document.querySelectorAll('.widget-showcase adw-button').forEach(btn => {
            if (!btn.id?.includes('trigger')) { // Avoid dialog/banner triggers for this generic toast
                btn.addEventListener('click', (e) => {
                    if (e.target.disabled) return;
                    let label = e.target.getAttribute('aria-label') || e.target.textContent.trim() || e.target.iconName || "Button";
                    Adw.createToast(`${label} clicked`, { timeout: 1500 });
                });
            }
        });

        // --- Controls ---
        document.getElementById('chk-1')?.addEventListener('change', (e) => Adw.createToast(`Checkbox is ${e.target.checked ? 'checked' : 'unchecked'}`));
        document.getElementById('switch-1')?.addEventListener('change', (e) => Adw.createToast(`Switch is ${e.target.active ? 'on' : 'off'}`));

        document.querySelectorAll('adw-radio-button[name="my-radio-group"]').forEach(radio => {
            radio.addEventListener('change', (e) => {
                if (e.target.checked) Adw.createToast(`Radio selected: ${e.target.value}`);
            });
        });

        const spinBtn1 = document.getElementById('spin-btn-1');
        spinBtn1?.addEventListener('value-changed', (e) => Adw.createToast(`SpinButton value: ${e.detail.value}`, { timeout: 1000 }));

        const splitBtn1 = document.getElementById('split-btn-1');
        splitBtn1?.addEventListener('action-click', () => Adw.createToast('SplitButton 1: Main action clicked!'));
        splitBtn1?.addEventListener('dropdown-click', () => Adw.createToast('SplitButton 1: Dropdown clicked! (Menu not implemented in demo)'));

        const splitBtn2 = document.getElementById('split-btn-2');
        splitBtn2?.addEventListener('action-click', () => Adw.createToast('SplitButton 2 (Save): Main action clicked!'));
        splitBtn2?.addEventListener('dropdown-click', () => Adw.createToast('SplitButton 2 (Save): Dropdown clicked!'));

        const toggleBtn1 = document.getElementById('toggle-btn-1');
        toggleBtn1?.addEventListener('toggled', (e) => Adw.createToast(`Toggle '${e.target.label}' is ${e.detail.isActive ? 'active' : 'inactive'}`));
        const toggleBtn2 = document.getElementById('toggle-btn-2');
        toggleBtn2?.addEventListener('toggled', (e) => Adw.createToast(`Play toggle is ${e.detail.isActive ? 'active' : 'inactive'}`));

        const toggleGroup1 = document.getElementById('toggle-group-1');
        toggleGroup1?.addEventListener('active-changed', (e) => Adw.createToast(`ToggleGroup active: ${e.detail.value}`));

        // --- Rows ---
        document.getElementById('simple-action-row')?.addEventListener('click', () => Adw.createToast("Simple Action Row clicked!"));
        const expanderRow1 = document.getElementById('expander-row-1');
        expanderRow1?.addEventListener('toggled', (e) => Adw.createToast(`Expander '${e.target.getAttribute('title')}' is ${e.detail.expanded ? 'expanded' : 'collapsed'}`));

        const comboRow1 = document.getElementById('combo-row-1');
        comboRow1?.addEventListener('change', (e) => Adw.createToast(`ComboRow selection: ${e.detail.value}`));

        // --- Dialog Triggers ---
        const alertDialog = document.getElementById('alert-dialog-example');
        document.getElementById('trigger-alert-dialog')?.addEventListener('click', () => alertDialog?.open());
        alertDialog?.addEventListener('response', (e) => Adw.createToast(`Alert response: ${e.detail.value}`));

        const aboutDialog = document.getElementById('about-dialog-example');
        document.getElementById('trigger-about-dialog')?.addEventListener('click', () => aboutDialog?.open());
        // AboutDialog has its own close button, no specific response event needed here.

        const prefsDialog = document.getElementById('preferences-dialog-example');
        document.getElementById('trigger-preferences-dialog')?.addEventListener('click', () => prefsDialog?.open());

        // --- Banner & Toast Triggers (from misc section) ---
        const bannerContainerMain = document.getElementById('banner-container-main');
        document.getElementById('trigger-banner')?.addEventListener('click', () => {
            if (bannerContainerMain) {
                 // Clear previous banners in this container
                while(bannerContainerMain.firstChild) bannerContainerMain.removeChild(bannerContainerMain.firstChild);
                Adw.createBanner("This is an example banner.", { type: 'info', container: bannerContainerMain });
            }
        });
        document.getElementById('trigger-toast')?.addEventListener('click', () => {
            Adw.createToast("This is an example toast!", { actionName: "Undo", onAction: () => Adw.createToast("Undo clicked!") });
        });

        // --- Flap Toggle ---
        const mainFlap = document.getElementById('main-flap-example');
        document.getElementById('toggle-main-flap')?.addEventListener('click', () => mainFlap?.toggleFlap());
        mainFlap?.addEventListener('fold-changed', (e) => Adw.createToast(`Main Flap is now ${e.detail.isFolded ? 'closed' : 'open'}`));

        // --- TabView ---
        const mainTabView = document.getElementById('main-tab-view');
        mainTabView?.addEventListener('tab-selected', (e) => Adw.createToast(`Tab selected: ${e.detail.title}`));
        mainTabView?.addEventListener('tab-closed', (e) => Adw.createToast(`Tab closed: ${e.detail.title}`));


        console.log("Adwaita Web Showcase Initialized!");
    });
    </script>
</body>
</html>
