// Styles moved from app-demo/templates/base.html
@use 'variables'; // Added to access SASS variables like $adw-dark-5

// Header styles
.adw-header-bar__start .site-title-link {
    text-decoration: none;
    color: inherit;
    font-weight: var(--heading-font-weight, 700); // Use CSS var, fallback to bold
}
.adw-header-bar__start .site-title-link:hover,
.adw-header-bar__start .site-title-link:focus {
    text-decoration: none;
}
.adw-header-bar__end {
    display: flex;
    align-items: center;
    gap: var(--spacing-s);
}
.header-search-form {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
}
.profile-avatar-button img, .profile-avatar-button .adw-avatar-text {
    vertical-align: middle;
}

// Footer styles
.app-footer {
    border-top: 1px solid var(--border-color);
    padding: var(--spacing-s) var(--spacing-m);
    margin-top: var(--spacing-xl);
    background-color: var(--window-bg-color); // Adwaita window background
}

.app-footer .adw-toolbar__end {
    display: flex;
    align-items: center;
    gap: var(--spacing-s);
}

// Basic CSS-only Expander Row (used in profile.html)
.adw-css-expander-row {
    summary.adw-action-row {
        list-style: none; // Remove default marker
        position: relative;
        // Ensure chevron is included in padding calculation if using padding-right on summary
        // (Assuming .adw-action-row itself has appropriate padding)

        &::-webkit-details-marker {
            display: none; // Hide WebKit default marker
        }

        // Custom chevron
        &::after {
            content: '';
            display: inline-block;
            width: 0.5em;
            height: 0.5em;
            border-right: 0.15em solid currentColor;
            border-bottom: 0.15em solid currentColor;
            transform: rotate(45deg); // Default: pointing down-right
            transition: transform 0.2s ease-out;
            position: absolute;
            right: var(--spacing-m); // Adjusted to use spacing var, closer to Adwaita standard
            top: 50%;
            margin-top: -0.35em; // Adjust vertical based on chevron size and border
            opacity: 0.7;
        }
    }

    &[open] > summary.adw-action-row::after {
        transform: rotate(-135deg); // Pointing up-right
    }

    .adw-expander-row-content {
        padding: var(--spacing-m);
        white-space: pre-wrap; // For preserving formatting in bio
        border-top: 1px solid var(--divider-color); // Use Adwaita divider color
        margin-top: -1px; // Collapses border with summary when open
    }
}

// --- Styles from index.html ---
.page-title-centered {
    text-align: center;
    margin-bottom: var(--spacing-l);
}

.meta-section {
    margin-top: var(--spacing-xs);
}

.meta-label-strong {
    font-weight: bold; // Or use SASS var $font-weight-bold
}

.app-status-page-icon { // For specific sizing if default adw-status-page-icon isn't enough
    font-size: 3rem; // Was inline
}

.pagination-controls {
    margin-top: var(--spacing-l);
    display: flex;
    justify-content: center;
    gap: var(--spacing-xs);

    .adw-button.flat[disabled],
    .adw-button[disabled] { // General disabled button styling for ellipsis
        pointer-events: none; // Already default for disabled, but can be explicit
        // color: var(--text-color-secondary); // Optional: make ellipsis more muted
    }
    .adw-button.active { // Ensure active pagination button is bold if not already default
        font-weight: bold;
    }
}


// --- Styles from post.html ---
.post-meta-terms-label { // For "Categories:", "Tags:" labels in post view
    font-weight: bold;
}

.post-actions-container {
    display: flex; // Added display flex
    justify-content: flex-end;
    margin-top: var(--spacing-l);
    gap: var(--spacing-s); // Added gap for buttons
}

// For the form that contains only a delete button
.delete-post-form-inline {
    display: inline; // For forms that are just a button
    margin: 0; // Reset margin for inline forms
}

.comment-header-box {
    align-items: center;
    // gap: var(--spacing-s); // If direct children of adw-box need gap
}

.comment-author-link-strong {
    font-weight: bold;
}

.comment-delete-form-container {
    text-align: right;
    margin-top: var(--spacing-s);
}

.comment-form-field-row { // Specific to comment text area if needed beyond global .form-field-row
    // margin-top: var(--spacing-xs); // This was too little, form-field-row default is --spacing-s
}
.comment-form-actions { // Styles for the container of the submit button in comment form
    border-top: none; // Overriding default list-box header style perhaps
    padding-top: var(--spacing-s);
}

.related-posts-container {
    margin-top: var(--spacing-xl);
}

.back-to-posts-container {
    display: flex; // Added
    justify-content: center;
    margin-top: var(--spacing-xl);
}

// --- Styles from create_post.html & edit_post.html (some may be general form styles) ---
.form-page-header { // For centered headers on form pages like create_post
    text-align: center;
    margin-bottom: var(--spacing-l);
}

// General form field structure if not using adw-entry-row or adw-action-row
.form-field-row {
    margin-top: var(--spacing-s); // Default top margin for a form field row
    &.content-field-row { // Specific for the larger content textarea
         // margin-top: var(--spacing-s); // Already set by .form-field-row
    }
    .form-field-label-block { // For labels that should be block display
        display: block;
        margin-bottom: var(--spacing-xs);
    }
    .form-field-error-container { // Container for error messages for these rows
        margin-top: var(--spacing-xs);
    }
}

.form-actions-container { // General form actions (save, publish, cancel etc.)
    margin-top: var(--spacing-l);
    display: flex;
    align-items: center; // Align items vertically
    gap: var(--spacing-s);

    &.form-actions-end { // Aligns buttons to the right
        justify-content: flex-end;
    }
    &.form-actions-space-between { // For edit_post.html like layout
        justify-content: space-between;
    }
}

// --- Styles from profile.html ---
.profile-page-main-box {
    padding-top: var(--spacing-l);
}

.profile-pagination-box { // For the adw-box containing pagination controls
    margin-top: var(--spacing-l);
    // display: flex; justify-content: center; // Handled by .adw-box.justify-center
}

// Prose styling for user-generated content (post content, comments, bio)
.styled-text-content {
    line-height: 1.6;

    p {
        margin-bottom: var(--spacing-m);
    }

    h1, h2, h3, h4, h5, h6 {
        margin-top: var(--spacing-l);
        margin-bottom: var(--spacing-s);
        font-weight: var(--heading-font-weight, 700);
    }
    h1 { font-size: var(--font-size-h1); }
    h2 { font-size: var(--font-size-h2); }
    h3 { font-size: var(--font-size-h3); }
    h4 { font-size: var(--font-size-h4); }

    ul, ol {
        margin-bottom: var(--spacing-m);
        padding-left: var(--spacing-l);
    }
    li {
        margin-bottom: var(--spacing-xs);
    }

    blockquote {
        margin: var(--spacing-m) 0;
        padding: var(--spacing-s) var(--spacing-m);
        border-left: 4px solid var(--border-color);
        background-color: var(--button-bg-color); // A slightly off-bg color
        color: var(--text-color-secondary);
        font-style: italic;

        p:last-child {
            margin-bottom: 0;
        }
    }

    pre {
        background-color: var(--headerbar-bg-color); // Use a distinct background
        color: var(--text-color);
        padding: var(--spacing-m);
        border-radius: var(--border-radius-medium);
        overflow-x: auto;
        font-family: var(--monospace-font-family);
        font-size: 0.9em; // Slightly smaller for code blocks
        line-height: 1.4;
    }
    code { // Inline code
        font-family: var(--monospace-font-family);
        // Using a subtle, semi-transparent version of a base dark color for light theme
        background-color: rgba(variables.$adw-dark-5, 0.05);
        padding: 0.1em 0.3em;
        border-radius: var(--border-radius-small);
        font-size: 0.9em;
    }
    :root.theme-dark .styled-text-content code {
        // Using a subtle, semi-transparent version of a base light color for dark theme
        background-color: rgba(variables.$adw-light-1, 0.08);
    }
    pre code { // Reset for code inside pre
      background-color: transparent;
      padding: 0;
      border-radius: 0;
      font-size: inherit; // Inherit from pre
    }

    a {
        color: var(--link-color);
        text-decoration: underline;
        &:hover {
            color: var(--link-hover-color);
        }
    }

    hr {
        border: none;
        border-top: 1px solid var(--divider-color);
        margin: var(--spacing-l) 0;
    }
    // Add more styling for tables, images etc. as needed
}

// Ensure section dividers are styled subtly
hr.section-divider {
    border: none;
    border-top: 1px solid var(--divider-color);
    margin: var(--spacing-xl) 0; // Larger margin for section breaks
}

// --- New Sidebar Layout Styles ---
html, body {
    height: 100%;
    margin: 0;
    display: flex;
    flex-direction: column;
}

body {
    overflow: hidden; // Prevent body scroll, individual areas will scroll
}

.adw-header-bar {
    flex-shrink: 0; // Header should not shrink
}

.app-body-container {
    display: flex;
    flex-grow: 1;
    overflow: hidden; // Important for child elements to scroll correctly
    // background-color: var(--window-pane-bg-color, var(--window-bg-color)); // A slightly different bg if sidebar is distinct
}

.app-sidebar {
    width: 240px; // Common sidebar width
    flex-shrink: 0;
    background-color: var(--headerbar-bg-color); // Sidebar often has a slightly different bg, like headerbar
    border-right: 1px solid var(--border-color);
    overflow-y: auto;
    display: flex;
    flex-direction: column;

    .sidebar-nav {
        &.adw-list-box.flat { // Make sidebar nav list box truly flat and part of sidebar
            border: none;
            border-radius: 0;
            background-color: transparent; // Inherit sidebar background
        }
        .adw-action-row {
            // Ensure rows in sidebar nav look good
            padding-left: var(--spacing-m); // Default listbox row padding is var(--spacing-m)
            padding-right: var(--spacing-m);
            // No border-bottom needed if listbox is flat and bg is uniform
            border-bottom: none;

            &:hover {
                background-color: rgba(var(--text-color-rgb, 0,0,0), 0.06); // Subtle hover
            }
            &.selected, // TODO: Need a way to mark current page as selected in sidebar
            &.active { // Assuming .active might be used by JS for current page
                background-color: rgba(var(--accent-color-rgb, 0,100,200), 0.15); // Subtle accent selection
                .adw-action-row-title {
                    color: var(--accent-color);
                    font-weight: bold;
                }
            }
        }
    }
}

.app-content-area {
    flex-grow: 1;
    display: flex;
    flex-direction: column;
    overflow-y: auto; // Main content area scrolls
    background-color: var(--window-bg-color); // Standard window background for content

    .page-content-wrapper {
        flex-grow: 1; // Allows main content to push footer down
        // Padding for actual page content is often here or on main.adw-clamp
        // For now, rely on main.adw-clamp's implicit behavior or specific page content containers
        // like adw-preferences-page.
    }

    .main-content { // Ensure main content within adw-clamp has some breathing room from top
        padding-top: var(--spacing-xl);
        padding-bottom: var(--spacing-xl); // Space before footer
    }


    .app-footer {
        flex-shrink: 0; // Footer should not shrink
        // background-color: var(--headerbar-bg-color); // Footer often matches header/sidebar bg
        // border-top: 1px solid var(--border-color); // Already has border-top
    }
}

// Ensure .adw-clamp within .app-content-area doesn't get too wide if sidebar is present
// This might need adjustment based on final look
.app-content-area > .page-content-wrapper > .adw-clamp.main-content {
    // max-width: calc(100% - var(--spacing-xl) * 2); // Ensure clamp respects padding of content area
    // The clamp itself has a max-width, so this might not be needed.
}

// RGB variables moved to _variables.scss

// --- Styles from edit_profile.html ---
.profile-bio-textarea { // Applied to the textarea for user's biography
    margin-top: var(--spacing-xs);
    width: 100%; // Make textarea take full width of its container
}

.profile-photo-widget-container { // Container for photo upload button and cropper preview
    display: flex;
    flex-direction: column;
    align-items: flex-end; // Align items to the right (end of the row)
    gap: var(--spacing-s);
}

.hidden-file-input { // For the actual <input type="file">
    display: none;
}

.cropper-container-wrapper { // Wrapper for the Cropper.js preview area
    width: 150px;
    height: 150px;
    // Conditional display (hidden/shown by JS) is handled by adding/removing a 'hidden' class or direct style by JS
    &.hidden { // Add this class via JS to hide it initially or when no image
        display: none;
    }
}

.current-photo-display { // Container for showing current avatar next to upload options
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
}

.edit-profile-form-actions { // Specific for the action buttons on the edit profile form
    @extend .form-actions-container; // Inherits display:flex, gap, margin-top
    @extend .form-actions-end;       // Inherits justify-content: flex-end
    padding-top: var(--spacing-l);   // Adds specific padding needed for this form
}

// --- Responsive Sidebar Styles ---
$app-sidebar-breakpoint: 768px; // Breakpoint for mobile/tablet view

.app-sidebar-toggle {
    display: none; // Hidden by default on larger screens
}

// Default (Desktop / Large Screen) Styles have already been defined for .app-sidebar, .app-body-container etc.
// .app-sidebar { width: 240px; ... }
// .app-body-container { display: flex; ... }

@media (max-width: #{$app-sidebar-breakpoint - 1px}) {
    .app-sidebar-toggle {
        display: inline-flex; // Show hamburger button
    }

    .profile-avatar-button { // Hide profile button in header start on small screens to make space for hamburger
        display: none;
    }

    .app-sidebar {
        position: fixed;
        left: 0;
        top: 0; // Should align below header if header is fixed. Assuming header is part of normal flow for this.
        // If header is position:fixed, then top should be var(--header-height, 56px) or similar.
        // For now, assuming it covers the whole screen, including under a non-fixed header.
        // Let's adjust if header is fixed. The header is part of the body's flex column.
        // So, the sidebar overlay should start from the very top of the viewport.
        height: 100%;
        z-index: 1000; // Ensure it's above content
        transform: translateX(-100%);
        transition: transform 0.25s ease-in-out;
        box-shadow: var(--dialog-box-shadow); // Give it some shadow like a dialog when overlayed

        &.sidebar-open {
            transform: translateX(0);
        }
    }

    // Optional: Add a backdrop when sidebar is open on mobile
    .app-sidebar-backdrop {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0,0,0,0.3);
        z-index: 999; // Below sidebar, above content
        opacity: 0;
        visibility: hidden;
        transition: opacity 0.25s ease-in-out, visibility 0s 0.25s linear;

        &.active {
            opacity: 1;
            visibility: visible;
            transition-delay: 0s;
        }
    }

    .app-content-area {
        // On small screens, content area takes full width as sidebar is an overlay
        // No specific width change needed if sidebar is position:fixed
    }

// Styles for post items in index.html to make them more card-like
.blog-post-card {
  background-color: var(--card-background-color, var(--window-bg-color)); // Fallback to window-bg
  border-radius: var(--card-border-radius, var(--border-radius-large));
  border: 1px solid var(--card-border-color, var(--borders-color));
  box-shadow: var(--card-box-shadow, 0 1px 2px rgba(0,0,0,0.05), 0 2px 8px rgba(0,0,0,0.05));
  margin-bottom: var(--spacing-m); // Space between cards
  padding: var(--spacing-m); // Internal padding for the card content

  // Adjustments for when adw-action-row is used as a card base
  &.adw-action-row {
    // Override default action row padding if custom card padding is preferred
    // padding-top: var(--spacing-m);
    // padding-bottom: var(--spacing-m);
    // padding-left: var(--spacing-m);
    // padding-right: var(--spacing-m);

    .adw-action-row-title {
      font-size: var(--font-size-h3); // Make title a bit larger for cards
      // color: var(--card-title-color, var(--heading-color));
    }
    .adw-action-row-subtitle {
      // Ensure subtitle color is appropriate for card background
      // color: var(--card-subtitle-color, var(--text-color));
    }
    // Remove the default bottom border from action rows when they are cards
    border-bottom: none;
    &:last-child { // Ensure last card also has no bottom border from listbox context
        border-bottom: none;
    }
  }

  &:hover {
    // background-color: var(--card-hover-background-color, var(--hover-bg-color));
    border-color: var(--card-hover-border-color, var(--accent-color));
    box-shadow: var(--card-hover-box-shadow, 0 2px 4px rgba(0,0,0,0.07), 0 4px 12px rgba(0,0,0,0.07));
  }
}

// Ensure the .blog-posts-list.flat (which is an adw-list-box) has no internal row separators
// if .blog-post-card provides its own borders/visual separation.
.blog-posts-list.adw-list-box.flat {
    .adw-action-row.blog-post-card { // Target only our cards within this specific list
        border-bottom: none; // Remove default action row separator
        & + .adw-action-row.blog-post-card { // If there's another card after this one
            // margin-top: var(--spacing-m); // Already handled by margin-bottom on card
        }
    }
    // Remove default listbox background and borders if cards handle it all
    background-color: transparent;
    border: none;
    box-shadow: none;
}
}

.comment-card {
  // Similar to blog-post-card, but perhaps slightly less emphasis or different padding
  background-color: var(--card-background-color, var(--window-bg-color));
  border-radius: var(--card-border-radius, var(--border-radius-default)); // Default radius for comments might be smaller
  border: 1px solid var(--card-border-color, var(--borders-color));
  // box-shadow: var(--card-box-shadow, 0 1px 2px rgba(0,0,0,0.05)); // Optional: less shadow for comments
  margin-bottom: var(--spacing-s); // Space between comment cards
  padding: var(--spacing-s); // Internal padding

  .comment-header {
    margin-bottom: var(--spacing-xs);
  }

  .comment-text {
    margin-bottom: var(--spacing-xs);
    font-size: var(--font-size-base); // Ensure comment text is base size
    line-height: var(--line-height-base);
  }

  .comment-actions {
    // Styles for the container of reply/flag/delete buttons
    border-top: 1px solid var(--divider-color);
    padding-top: var(--spacing-xs);
    margin-top: var(--spacing-s);
  }

  // Styling for nested reply forms if they appear directly within a card
  .reply-form-container {
    border-top: 1px dashed var(--divider-color); // Dashed line for reply form section
    padding-top: var(--spacing-s);
    margin-top: var(--spacing-s);
    .adw-textarea {
        min-height: 60px; // Smaller textarea for replies
    }
  }
}

// Ensure the .comments-list.flat (which is an adw-list-box) has no internal row separators
// if .comment-card provides its own borders/visual separation.
.comments-list.adw-list-box.flat {
    .comment-card { // Target only our cards within this specific list
        border-bottom: none; // Remove default action row separator if it were one
        & + .comment-card {
            // margin-top: var(--spacing-s); // Already handled by margin-bottom on card
        }
    }
    // Remove default listbox background and borders if cards handle it all
    background-color: transparent;
    border: none;
    box-shadow: none;
}
