// adwaita-web/scss/_card.scss
@use 'variables';
@use 'mixins'; // This is the one to keep
@use 'sass:color';
// Ensure mixins are available if apply-card-style is defined there.
// However, if apply-card-style is specific to cards, it could also live in this file
// and not be in _mixins.scss. For now, assuming it's in _mixins.scss as per plan.
// @use 'mixins'; // This was the duplicate

// General .card style class from Libadwaita
// https://gnome.pages.gitlab.gnome.org/libadwaita/doc/main/style-classes.html#boxed-lists-cards
.adw-card, .card { // Allow .card as an alias for consistency with Libadwaita docs
  @include mixins.apply-card-style;

  // Original properties that are now in the mixin:
  // background-color: var(--card-bg-color);
  // color: var(--card-fg-color); // Text color for content within the card
  // border-radius: var(--border-radius-large); // Libadwaita cards use a larger radius
  // padding: var(--spacing-m); // Default padding, can be overridden by specific components
  // box-shadow: 0 1px 2px rgba(0,0,0,0.05), 0 2px 4px rgba(0,0,0,0.05);
  // display: block; // Cards are usually block elements


  // Libadwaita cards typically have a subtle outer shadow and an inner "border" created by card-shade-color
  // The outer shadow is not explicitly defined as a variable in Libadwaita, but is part of the look.
  // The --card-shade-color is used for internal separators in boxed lists or for an inner border effect.
  // For a general card, we might apply a subtle shadow.
  // Box shadow for cards: a subtle outer shadow.
  // For the inner border effect common in boxed lists, that's usually applied to rows within.
  // For a standalone card, it might just have the background and shadow.
  // The actual box-shadow is now applied via the @include mixins.apply-card-style;
  // box-shadow: var(--stronger-card-box-shadow); // This line is effectively handled by the mixin

  // If a card is meant to look like a boxed list container, it might also have an effective "inner border"
  // This could be approximated by an inset shadow using --card-shade-color or by styling child elements.
  // For now, focusing on the standalone card appearance.

  display: block; // Cards are usually block elements

  &.activatable {
    // From Libadwaita: "If a widget with the .card style class also has the .activatable style class,
    // it will also have hover and active states similar to an activatable row inside a boxed list."
    cursor: pointer;
    transition: background-color 0.1s ease-out;

    &:hover {
      background-color: rgba(var(--card-fg-color-rgb), 0.05);
    }
    &:active {
      background-color: rgba(var(--card-fg-color-rgb), 0.08);
    }
     &:focus, &:focus-visible {
        outline: none;
        // Combine focus ring with the new stronger card shadow
        box-shadow: 0 0 0 var(--focus-ring-width) var(--focus-ring-color), var(--stronger-card-box-shadow);
    }
  }
}

// `.adw-button.card` styling - when a button itself is styled as a card
// Libadwaita: "If the .card style class is applied to a GtkButton, it will get these states automatically"
.adw-button.card {
  // Reset button's own padding, border, default background/color
  padding: 0; // Card padding will apply
  border: none;
  background-color: var(--card-bg-color);
  color: var(--card-fg-color);
  border-radius: var(--border-radius-large);
  box-shadow: var(--stronger-card-box-shadow); // Use the new stronger shadow variable
  text-align: inherit; // Inherit text align from card content if any
  display: block; // Make button behave like a block card

  // Apply card's activatable hover/active states
   &:hover {
      background-color: rgba(var(--card-fg-color-rgb), 0.05);
  }
  &:active {
      background-color: rgba(var(--card-fg-color-rgb), 0.08);
  }
  &:focus, &:focus-visible {
      outline: none;
      // Combine focus ring with the new stronger card shadow
      box-shadow: 0 0 0 var(--focus-ring-width) var(--focus-ring-color), var(--stronger-card-box-shadow);
  }

  // Content inside the button should be padded by the card's padding.
  // This assumes the button's direct children are the content.
  > * {
    padding: var(--spacing-m);
  }
}

// Styles for photo thumbnails within cards in the feed
.photo-item-card { // Specific to the photo cards in the feed
  .photo-card-clickable-content {
    display: block; // Make the anchor fill the content area
    padding: var(--spacing-m); // Standard card padding
    &:hover {
      background-color: rgba(var(--card-fg-color-rgb), 0.02); // Very subtle hover for the content area
    }
  }

  .photo-thumbnails-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); // Responsive grid for multiple thumbnails
    gap: var(--spacing-xs);
    margin-bottom: var(--spacing-s); // Space before caption if any

    // If only one item, we might want it to be larger or centered.
    // The template handles single item by not being in the loop,
    // but this can style the container if it has few items.
    &:has(.photo-thumbnail-link:nth-child(1):last-child) { // If only one photo
      grid-template-columns: minmax(150px, 250px); // Single photo can be larger
      justify-content: center; // Center the single photo if grid takes full width
    }
     &:has(.photo-thumbnail-link:nth-child(2):last-child) { // If two photos
      grid-template-columns: repeat(2, minmax(100px, 1fr));
    }
    &:has(.photo-thumbnail-link:nth-child(3):last-child) { // If three photos
      grid-template-columns: repeat(3, minmax(80px, 1fr));
    }
  }

  .photo-thumbnail-link {
    display: block;
    position: relative;
    overflow: hidden;
    border-radius: var(--border-radius-medium);
    aspect-ratio: 1 / 1; // Square thumbnails
    background-color: var(--shade-color); // Placeholder background

    &:hover {
      box-shadow: 0 0 0 2px var(--accent-color); // Highlight on hover
    }
  }

  .photo-thumbnail-img {
    width: 100%;
    height: 100%;
    object-fit: cover; // Cover the area, cropping if necessary
    transition: transform 0.2s ease-out;

    .photo-thumbnail-link:hover & {
      transform: scale(1.05); // Slight zoom on hover
    }
  }

  // For a card that is explicitly showing a single, larger thumbnail (not in a grid)
  .single-photo-link { // Applied to the link around a single photo
    display: block;
    text-align: center; // Center the image if it's not full width
    margin-bottom: var(--spacing-s);
  }
  .single-photo-thumbnail-img { // Applied to the image itself for single display
    max-width: 100%;
    max-height: 400px; // Limit height for single preview
    width: auto; // Maintain aspect ratio
    height: auto; // Maintain aspect ratio
    object-fit: contain;
    border-radius: var(--border-radius-medium);
  }

  .photo-caption-text {
    color: var(--secondary-fg-color); // Use secondary text color for caption
    font-size: var(--font-size-small);
    text-align: left; // Align caption to the left under the grid/image
    // padding was moved to the template for better control
  }

  // Ensure footer is below the clickable content if caption is part of it
  .blog-post-card__footer {
    margin-top: var(--spacing-s);
    padding-top: 0; // Removed default top padding from footer if content above has its own.
                    // The template now adds its own padding to the footer.
  }
}
