// scss/_dialog.scss
@use 'variables';
@use 'mixins'; // For z-index variables if defined there

.adw-dialog {
  background-color: var(--dialog-bg-color);
  color: var(--dialog-fg-color);
  border-radius: var(--window-radius); // Dialogs are like small windows
  box-shadow: var(--dialog-box-shadow); // Defined in _variables.scss
  padding: 0; // Dialog manages its own internal padding via header/content/footer
  width: 90%; // Responsive width
  max-width: 550px; // Max width for larger screens
  position: fixed; // For centering and overlay
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%) scale(0.95); // Initial state for animation
  z-index: var(--z-index-dialog);
  opacity: 0;
  visibility: hidden; // Start hidden
  transition: opacity 0.15s ease-out, transform 0.15s ease-out, visibility 0s linear 0.15s;

  &.open {
    opacity: 1;
    transform: translate(-50%, -50%) scale(1);
    visibility: visible;
    transition: opacity 0.15s ease-out, transform 0.15s ease-out, visibility 0s linear 0s;
  }

  // Dialog Header (AdwAlertDialog uses this structure implicitly)
  .adw-dialog-header {
    display: flex;
    justify-content: space-between; // Title left, close button right
    align-items: center;
    padding: var(--spacing-m); // Standard padding
    border-bottom: var(--border-width) solid var(--border-color);

    .adw-dialog-title {
      font-size: var(--title-3-font-size); // Use typography utility class size
      font-weight: var(--font-weight-bold);
      color: inherit; // Inherits --dialog-fg-color
    }

    // Styling for a dedicated close button in the header
    .adw-dialog-close-button.adw-button {
      // Assuming .adw-button provides base button styling (padding, border, etc.)
      // And .circular, .flat modify it. We primarily need to set the icon here.
      // If the button is purely iconic, it might need width/height settings too.
      // Let's assume it's a circular flat button, so padding might create the size.
      // The icon itself:
      .adw-icon { // If an <span class="adw-icon"> is used inside the button
        background-color: currentColor;
        -webkit-mask-image: url('../data/icons/symbolic/window-close-symbolic.svg');
        mask-image: url('../data/icons/symbolic/window-close-symbolic.svg');
        -webkit-mask-repeat: no-repeat;
        mask-repeat: no-repeat;
        -webkit-mask-position: center;
        mask-position: center;
        -webkit-mask-size: contain;
        mask-size: contain;
        width: var(--icon-size-base); // Standard icon size
        height: var(--icon-size-base);
        display: inline-block; // Ensure it takes space
      }
      // If the button *is* the icon (no inner .adw-icon span):
      // background-color: currentColor;
      // -webkit-mask-image: url('../data/icons/symbolic/window-close-symbolic.svg');
      // mask-image: url('../data/icons/symbolic/window-close-symbolic.svg');
      // width: var(--icon-size-base); height: var(--icon-size-base); etc.
      // For now, sticking to .adw-icon child pattern.
    }
  }

  // Dialog Content Area
  .adw-dialog-content {
    padding: var(--spacing-l); // Generous padding for content
    line-height: 1.6;
    color: inherit;

    // For AdwAlertDialog, title might be here if no header is used
    .adw-alert-dialog-heading { // Specific class for AlertDialog heading
        font-size: var(--title-2-font-size);
        font-weight: var(--font-weight-bold);
        margin-bottom: var(--spacing-xs);
        text-align: center;
    }
    .adw-alert-dialog-body { // Specific class for AlertDialog body text
        font-size: var(--font-size-base);
        text-align: center;
        opacity: var(--dim-opacity); // Body text is often dimmed
        margin-bottom: var(--spacing-l);
    }
  }

  // Dialog Footer / Actions Area
  // This style applies to .adw-dialog-footer, .adw-dialog-buttons (legacy),
  // and .adw-dialog__actions-buttons-container (used by JS factory and recommended for slotted buttons)
  .adw-dialog-footer,
  .adw-dialog-buttons,
  .adw-dialog__actions-buttons-container { // Added .adw-dialog__actions-buttons-container
    display: flex;
    justify-content: flex-end; // Buttons typically to the right
    align-items: center;
    padding: var(--spacing-m);
    border-top: var(--border-width) solid var(--border-color);
    gap: var(--spacing-s); // Gap between buttons
  }


  // AdwAlertDialog specific button layout (often centered or full-width if few)
  // This would typically be inside .adw-dialog-content if no footer is explicitly used by AlertDialog structure
  .adw-alert-dialog-responses {
    display: flex;
    flex-direction: column; // Default for stacked buttons in simple alerts
    gap: var(--spacing-s);
    margin-top: var(--spacing-m);

    .adw-button {
      width: 100%; // Buttons often take full width in simple alerts
    }

    // For horizontal button layout in alerts (e.g. confirm/cancel)
    &.horizontal {
        flex-direction: row;
        justify-content: flex-end; // Or center, depending on HIG
         .adw-button {
            width: auto; // Auto width for horizontal buttons
         }
    }
  }

  // --- AdwAboutDialog Specific Styles ---
  &.adw-about-dialog {
    .adw-dialog__content {
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center; // Center text for most elements within
      padding-top: var(--spacing-xl); // More top padding for About dialog content
      padding-bottom: var(--spacing-xl); // More bottom padding
    }

    .adw-about-dialog-logo {
      width: 64px; // Standard Adwaita About Dialog logo size
      height: 64px;
      margin-bottom: var(--spacing-l);
      border-radius: var(--border-radius-small); // Slight rounding if the logo isn't circular
    }

    .application-name { // This already has .adw-label and .title-1
      // .title-1 provides font size and weight. We might want specific margin.
      margin-bottom: var(--spacing-xxs); // Very small margin below app name
      color: var(--window-fg-color); // Ensure it uses the main text color
    }

    .version { // This already has .adw-label and .body-2
      // .body-2 provides font size. Adwaita often uses slightly dimmed for version.
      opacity: var(--dim-opacity);
      margin-top: 0;
      margin-bottom: var(--spacing-m);
    }

    .comments { // This already has .adw-label
      font-size: var(--font-size-base); // Ensure base font size
      margin-top: 0;
      margin-bottom: var(--spacing-l);
      max-width: 90%; // Prevent comments from being too wide
    }

    // Container for the website link
    p:has(> .adw-link) { // Target the <p> tag containing the website link
      margin-top: 0;
      margin-bottom: var(--spacing-l);
      .adw-link {
        font-size: var(--font-size-base);
      }
    }


    .copyright { // This already has .adw-label and .caption
      // .caption provides font size and often dimmed color.
      margin-top: var(--spacing-l); // Space above copyright
      margin-bottom: 0; // No margin below the last element
      opacity: var(--dim-opacity);
    }

    // No explicit footer/buttons for AboutDialog by default, content flows to bottom.
    // If a footer were added, it would use .adw-dialog-footer styles.
  }
}

.adw-dialog-backdrop {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: var(--dialog-backdrop-color); // Defined in _variables.scss
  z-index: var(--z-index-dialog-backdrop);
  opacity: 0;
  visibility: hidden; // Start hidden
  transition: opacity 0.15s ease-out, visibility 0s linear 0.15s;

  &.open {
    opacity: 1; // Matches Libadwaita's default backdrop opacity (0.2 for dark, 0.4 for light)
                // Our var(--dialog-backdrop-color) is rgba(0,0,0,0.4)
    visibility: visible;
    transition: opacity 0.15s ease-out, visibility 0s linear 0s;
  }
}