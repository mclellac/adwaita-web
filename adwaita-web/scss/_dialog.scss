// scss/_dialog.scss
@use 'variables';
@use 'mixins'; // For z-index variables if defined there

.adw-dialog {
  background-color: var(--dialog-bg-color);
  color: var(--dialog-fg-color);
  border-radius: var(--window-radius); // Dialogs are like small windows
  box-shadow: var(--dialog-box-shadow); // Defined in _variables.scss
  padding: 0; // Dialog manages its own internal padding via header/content/footer
  width: 90%; // Responsive width
  max-width: 550px; // Max width for larger screens
  position: fixed; // For centering and overlay
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%) scale(0.95); // Initial state for animation
  z-index: var(--z-index-dialog);
  opacity: 0;
  visibility: hidden; // Start hidden
  transition: opacity 0.15s ease-out, transform 0.15s ease-out, visibility 0s linear 0.15s;

  &.open {
    opacity: 1;
    transform: translate(-50%, -50%) scale(1);
    visibility: visible;
    transition: opacity 0.15s ease-out, transform 0.15s ease-out, visibility 0s linear 0s;
  }

  // Dialog Header (AdwAlertDialog uses this structure implicitly)
  .adw-dialog-header {
    display: flex;
    justify-content: space-between; // Title left, close button right
    align-items: center;
    padding: var(--spacing-m); // Standard padding
    border-bottom: var(--border-width) solid var(--border-color);

    .adw-dialog-title {
      font-size: var(--title-3-font-size); // Use typography utility class size
      font-weight: var(--font-weight-bold);
      color: inherit; // Inherits --dialog-fg-color
    }

    // Styling for a dedicated close button in the header
    .adw-dialog-close-button.adw-button {
      // Assuming .adw-button provides base button styling (padding, border, etc.)
      // And .circular, .flat modify it. We primarily need to set the icon here.
      // If the button is purely iconic, it might need width/height settings too.
      // Let's assume it's a circular flat button, so padding might create the size.
      // The icon itself:
      .adw-icon { // If an <span class="adw-icon"> is used inside the button
        background-color: currentColor;
        -webkit-mask-image: url('../data/icons/symbolic/window-close-symbolic.svg');
        mask-image: url('../data/icons/symbolic/window-close-symbolic.svg');
        -webkit-mask-repeat: no-repeat;
        mask-repeat: no-repeat;
        -webkit-mask-position: center;
        mask-position: center;
        -webkit-mask-size: contain;
        mask-size: contain;
        width: var(--icon-size-base); // Standard icon size
        height: var(--icon-size-base);
        display: inline-block; // Ensure it takes space
      }
      // If the button *is* the icon (no inner .adw-icon span):
      // background-color: currentColor;
      // -webkit-mask-image: url('../data/icons/symbolic/window-close-symbolic.svg');
      // mask-image: url('../data/icons/symbolic/window-close-symbolic.svg');
      // width: var(--icon-size-base); height: var(--icon-size-base); etc.
      // For now, sticking to .adw-icon child pattern.
    }
  }

  // Dialog Content Area
  .adw-dialog-content {
    padding: var(--spacing-l); // Generous padding for content
    line-height: 1.6;
    color: inherit;

    // For AdwAlertDialog, title might be here if no header is used
    .adw-alert-dialog-heading { // Specific class for AlertDialog heading
        font-size: var(--title-2-font-size);
        font-weight: var(--font-weight-bold);
        margin-bottom: var(--spacing-xs);
        text-align: center;
    }
    .adw-alert-dialog-body { // Specific class for AlertDialog body text
        font-size: var(--font-size-base);
        text-align: center;
        opacity: var(--dim-opacity); // Body text is often dimmed
        margin-bottom: var(--spacing-l);
    }
  }

  // Dialog Footer / Actions Area
  .adw-dialog-footer {
    display: flex;
    justify-content: flex-end; // Buttons typically to the right
    align-items: center;
    padding: var(--spacing-m);
    border-top: var(--border-width) solid var(--border-color);
    gap: var(--spacing-s); // Gap between buttons

    // AdwAlertDialog has a specific layout for responses (buttons)
    // This is a general footer, AlertDialog might have more specific button styling/layout.
  }

  // Old .adw-dialog-buttons, kept for compatibility, prefer .adw-dialog-footer
  .adw-dialog-buttons {
    @extend .adw-dialog-footer; // Inherit footer styles
  }


  // AdwAlertDialog specific button layout (often centered or full-width if few)
  // This would typically be inside .adw-dialog-content if no footer is explicitly used by AlertDialog structure
  .adw-alert-dialog-responses {
    display: flex;
    flex-direction: column; // Default for stacked buttons in simple alerts
    gap: var(--spacing-s);
    margin-top: var(--spacing-m);

    .adw-button {
      width: 100%; // Buttons often take full width in simple alerts
    }

    // For horizontal button layout in alerts (e.g. confirm/cancel)
    &.horizontal {
        flex-direction: row;
        justify-content: flex-end; // Or center, depending on HIG
         .adw-button {
            width: auto; // Auto width for horizontal buttons
         }
    }
  }
}
  // --- AdwAboutDialog Specific Styles ---
  // Targets .adw-dialog.adw-about-dialog
  &.adw-about-dialog {
    // Overall content wrapper for About Dialog (this is the .adw-dialog__content inside .adw-about-dialog)
    .adw-about-dialog__content-wrapper {
      display: flex;
      flex-direction: column;
      align-items: center; // Center content like logo, app name, version
      text-align: center;
      gap: var(--spacing-m); // Default gap between sections
      // Padding is on .adw-dialog-content, but we might want more specific for about
      padding: var(--spacing-l) var(--spacing-xl) var(--spacing-xl) var(--spacing-xl); // Generous padding

      > section { // Direct children sections
        width: 100%; // Sections take full width of content area
        margin-bottom: var(--spacing-m); // Space between sections
        &:last-child {
          margin-bottom: 0;
        }
      }
    }

    .adw-about-dialog__app-info {
      margin-bottom: var(--spacing-l); // Larger margin after app info block
    }

    .adw-about-dialog-logo {
      width: 64px;
      height: 64px;
      margin-bottom: var(--spacing-m); // Space after logo
      border-radius: var(--border-radius-medium);
      object-fit: cover;
    }

    .adw-about-dialog-application-name {
      font-size: var(--title-1-font-size);
      font-weight: var(--font-weight-bold);
      margin-bottom: var(--spacing-xxs);
      color: var(--window-fg-color);
    }

    .adw-about-dialog-version {
      font-size: var(--font-size-base);
      color: var(--secondary-fg-color);
      margin-top: 0;
      margin-bottom: var(--spacing-m);
    }

    .adw-about-dialog-comments {
      font-size: var(--font-size-base);
      margin-top: 0;
      margin-bottom: 0;
      max-width: 100%;
      line-height: var(--line-height-base);
      white-space: pre-wrap;
    }

    .adw-about-dialog__links {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: var(--spacing-s);
      margin-bottom: var(--spacing-l); // Space after links block

      .adw-button.pill {
        // Assuming .adw-button.pill is styled elsewhere (e.g. _button.scss)
        // to have a pill shape (large border-radius)
        // Example if not defined elsewhere:
        // border-radius: var(--pill-button-border-radius, 100px);
        // padding: var(--spacing-xs) var(--spacing-m);
      }
    }

    .adw-about-dialog-section-title {
      font-size: var(--title-4-font-size);
      font-weight: var(--font-weight-bold);
      margin-bottom: var(--spacing-s);
      text-align: left;
      border-bottom: 1px solid var(--border-color); // Add a separator line
      padding-bottom: var(--spacing-xs);
      margin-top: var(--spacing-l); // Space before a new section title
    }

    .adw-about-dialog__credits {
      text-align: left;
      .adw-about-dialog-credit-group {
        margin-bottom: var(--spacing-m);
        &:last-child { margin-bottom: 0; }
      }
      .adw-about-dialog-credit-title {
        font-size: var(--font-size-large);
        font-weight: var(--font-weight-bold);
        margin-bottom: var(--spacing-xs);
      }
      .adw-about-dialog-credit-list {
        list-style: none;
        padding-left: 0;
        margin: 0;
        li {
          font-size: var(--font-size-base);
          margin-bottom: var(--spacing-xxs);
          color: var(--secondary-fg-color); // Dim credit names slightly
        }
      }
    }

    .adw-about-dialog__translators {
      text-align: left;
      .adw-about-dialog-credit-title { // Reuse credit title style
         font-size: var(--font-size-large);
         font-weight: var(--font-weight-bold);
         margin-bottom: var(--spacing-xs);
      }
      .adw-about-dialog-translator-text {
         font-size: var(--font-size-base);
         white-space: pre-wrap;
         color: var(--secondary-fg-color);
      }
    }

    .adw-about-dialog__license {
      text-align: left;
      .adw-about-dialog-license-type {
        font-size: var(--font-size-base);
        font-weight: var(--font-weight-bold);
        margin-bottom: var(--spacing-xs);
      }
      .adw-about-dialog-license-text {
        font-family: var(--monospace-font-family);
        font-size: var(--font-size-small);
        padding: var(--spacing-s);
        background-color: var(--shade-color);
        border-radius: var(--border-radius-small);
        white-space: pre-wrap;
        overflow-x: auto;
        max-height: 150px; // Shorter height for license text
        border: 1px solid var(--border-color);
        color: var(--secondary-fg-color);
      }
    }

    .adw-about-dialog__release-notes,
    .adw-about-dialog__system-information {
        text-align: left;
        .adw-about-dialog-prose {
            font-size: var(--font-size-base);
            white-space: pre-wrap;
            background-color: var(--shade-color);
            padding: var(--spacing-s);
            border-radius: var(--border-radius-small);
            max-height: 150px;
            overflow-y: auto;
            border: 1px solid var(--border-color);
            color: var(--secondary-fg-color);
        }
    }

    .adw-about-dialog-copyright {
      font-size: var(--font-size-small);
      color: var(--secondary-fg-color);
      margin-top: var(--spacing-l);
      text-align: center;
    }
  }
} // This closing brace is for .adw-dialog

.adw-dialog-backdrop {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: var(--dialog-backdrop-color); // Defined in _variables.scss
  z-index: var(--z-index-dialog-backdrop);
  opacity: 0;
  visibility: hidden; // Start hidden
  transition: opacity 0.15s ease-out, visibility 0s linear 0.15s;

  &.open {
    opacity: 1; // Matches Libadwaita's default backdrop opacity (0.2 for dark, 0.4 for light)
                // Our var(--dialog-backdrop-color) is rgba(0,0,0,0.4)
    visibility: visible;
    transition: opacity 0.15s ease-out, visibility 0s linear 0s;
  }
}